90d579c413d7587ca9ed705ca1b0458a
'use strict';

var isElementType = require("../../utils/misc/isElementType.js");
require("../../utils/dataTransfer/Clipboard.js");
var isContentEditable = require("../../utils/edit/isContentEditable.js");
var isEditable = require("../../utils/edit/isEditable.js");
var input = require("../input.js");
var registry = require("./registry.js");
registry.behavior.keypress = (event, target, instance) => {
  if (event.key === 'Enter') {
    if (isElementType.isElementType(target, 'button') || isElementType.isElementType(target, 'input') && ClickInputOnEnter.includes(target.type) || isElementType.isElementType(target, 'a') && Boolean(target.href)) {
      return () => {
        instance.dispatchUIEvent(target, 'click');
      };
    } else if (isElementType.isElementType(target, 'input')) {
      const form = target.form;
      const submit = form === null || form === undefined ? undefined : form.querySelector('input[type="submit"], button:not([type]), button[type="submit"]');
      if (submit) {
        return () => instance.dispatchUIEvent(submit, 'click');
      } else if (form && SubmitSingleInputOnEnter.includes(target.type) && form.querySelectorAll('input').length === 1) {
        return () => instance.dispatchUIEvent(form, 'submit');
      } else {
        return;
      }
    }
  }
  if (isEditable.isEditable(target)) {
    const inputType = event.key === 'Enter' ? isContentEditable.isContentEditable(target) && !instance.system.keyboard.modifiers.Shift ? 'insertParagraph' : 'insertLineBreak' : 'insertText';
    const inputData = event.key === 'Enter' ? '\n' : event.key;
    return () => input.input(instance, target, inputData, inputType);
  }
};
const ClickInputOnEnter = ['button', 'color', 'file', 'image', 'reset', 'submit'];
const SubmitSingleInputOnEnter = ['email', 'month', 'password', 'search', 'tel', 'text', 'url', 'week'];
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJpc0VsZW1lbnRUeXBlIiwicmVxdWlyZSIsImlzQ29udGVudEVkaXRhYmxlIiwiaXNFZGl0YWJsZSIsImlucHV0IiwicmVnaXN0cnkiLCJiZWhhdmlvciIsImtleXByZXNzIiwiZXZlbnQiLCJ0YXJnZXQiLCJpbnN0YW5jZSIsImtleSIsIkNsaWNrSW5wdXRPbkVudGVyIiwiaW5jbHVkZXMiLCJ0eXBlIiwiQm9vbGVhbiIsImhyZWYiLCJkaXNwYXRjaFVJRXZlbnQiLCJmb3JtIiwic3VibWl0IiwidW5kZWZpbmVkIiwicXVlcnlTZWxlY3RvciIsIlN1Ym1pdFNpbmdsZUlucHV0T25FbnRlciIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJsZW5ndGgiLCJpbnB1dFR5cGUiLCJzeXN0ZW0iLCJrZXlib2FyZCIsIm1vZGlmaWVycyIsIlNoaWZ0IiwiaW5wdXREYXRhIl0sInNvdXJjZXMiOlsia2V5cHJlc3MuanMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgaXNFbGVtZW50VHlwZSA9IHJlcXVpcmUoJy4uLy4uL3V0aWxzL21pc2MvaXNFbGVtZW50VHlwZS5qcycpO1xucmVxdWlyZSgnLi4vLi4vdXRpbHMvZGF0YVRyYW5zZmVyL0NsaXBib2FyZC5qcycpO1xudmFyIGlzQ29udGVudEVkaXRhYmxlID0gcmVxdWlyZSgnLi4vLi4vdXRpbHMvZWRpdC9pc0NvbnRlbnRFZGl0YWJsZS5qcycpO1xudmFyIGlzRWRpdGFibGUgPSByZXF1aXJlKCcuLi8uLi91dGlscy9lZGl0L2lzRWRpdGFibGUuanMnKTtcbnZhciBpbnB1dCA9IHJlcXVpcmUoJy4uL2lucHV0LmpzJyk7XG52YXIgcmVnaXN0cnkgPSByZXF1aXJlKCcuL3JlZ2lzdHJ5LmpzJyk7XG5cbnJlZ2lzdHJ5LmJlaGF2aW9yLmtleXByZXNzID0gKGV2ZW50LCB0YXJnZXQsIGluc3RhbmNlKT0+e1xuICAgIGlmIChldmVudC5rZXkgPT09ICdFbnRlcicpIHtcbiAgICAgICAgaWYgKGlzRWxlbWVudFR5cGUuaXNFbGVtZW50VHlwZSh0YXJnZXQsICdidXR0b24nKSB8fCBpc0VsZW1lbnRUeXBlLmlzRWxlbWVudFR5cGUodGFyZ2V0LCAnaW5wdXQnKSAmJiBDbGlja0lucHV0T25FbnRlci5pbmNsdWRlcyh0YXJnZXQudHlwZSkgfHwgaXNFbGVtZW50VHlwZS5pc0VsZW1lbnRUeXBlKHRhcmdldCwgJ2EnKSAmJiBCb29sZWFuKHRhcmdldC5ocmVmKSkge1xuICAgICAgICAgICAgcmV0dXJuICgpPT57XG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuZGlzcGF0Y2hVSUV2ZW50KHRhcmdldCwgJ2NsaWNrJyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2UgaWYgKGlzRWxlbWVudFR5cGUuaXNFbGVtZW50VHlwZSh0YXJnZXQsICdpbnB1dCcpKSB7XG4gICAgICAgICAgICBjb25zdCBmb3JtID0gdGFyZ2V0LmZvcm07XG4gICAgICAgICAgICBjb25zdCBzdWJtaXQgPSBmb3JtID09PSBudWxsIHx8IGZvcm0gPT09IHVuZGVmaW5lZCA/IHVuZGVmaW5lZCA6IGZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbdHlwZT1cInN1Ym1pdFwiXSwgYnV0dG9uOm5vdChbdHlwZV0pLCBidXR0b25bdHlwZT1cInN1Ym1pdFwiXScpO1xuICAgICAgICAgICAgaWYgKHN1Ym1pdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAoKT0+aW5zdGFuY2UuZGlzcGF0Y2hVSUV2ZW50KHN1Ym1pdCwgJ2NsaWNrJyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGZvcm0gJiYgU3VibWl0U2luZ2xlSW5wdXRPbkVudGVyLmluY2x1ZGVzKHRhcmdldC50eXBlKSAmJiBmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0JykubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICgpPT5pbnN0YW5jZS5kaXNwYXRjaFVJRXZlbnQoZm9ybSwgJ3N1Ym1pdCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGlzRWRpdGFibGUuaXNFZGl0YWJsZSh0YXJnZXQpKSB7XG4gICAgICAgIGNvbnN0IGlucHV0VHlwZSA9IGV2ZW50LmtleSA9PT0gJ0VudGVyJyA/IGlzQ29udGVudEVkaXRhYmxlLmlzQ29udGVudEVkaXRhYmxlKHRhcmdldCkgJiYgIWluc3RhbmNlLnN5c3RlbS5rZXlib2FyZC5tb2RpZmllcnMuU2hpZnQgPyAnaW5zZXJ0UGFyYWdyYXBoJyA6ICdpbnNlcnRMaW5lQnJlYWsnIDogJ2luc2VydFRleHQnO1xuICAgICAgICBjb25zdCBpbnB1dERhdGEgPSBldmVudC5rZXkgPT09ICdFbnRlcicgPyAnXFxuJyA6IGV2ZW50LmtleTtcbiAgICAgICAgcmV0dXJuICgpPT5pbnB1dC5pbnB1dChpbnN0YW5jZSwgdGFyZ2V0LCBpbnB1dERhdGEsIGlucHV0VHlwZSk7XG4gICAgfVxufTtcbmNvbnN0IENsaWNrSW5wdXRPbkVudGVyID0gW1xuICAgICdidXR0b24nLFxuICAgICdjb2xvcicsXG4gICAgJ2ZpbGUnLFxuICAgICdpbWFnZScsXG4gICAgJ3Jlc2V0JyxcbiAgICAnc3VibWl0J1xuXTtcbmNvbnN0IFN1Ym1pdFNpbmdsZUlucHV0T25FbnRlciA9IFtcbiAgICAnZW1haWwnLFxuICAgICdtb250aCcsXG4gICAgJ3Bhc3N3b3JkJyxcbiAgICAnc2VhcmNoJyxcbiAgICAndGVsJyxcbiAgICAndGV4dCcsXG4gICAgJ3VybCcsXG4gICAgJ3dlZWsnXG5dO1xuIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUFZOztBQUVaLElBQUlBLGFBQWEsR0FBR0MsT0FBTyxvQ0FBb0MsQ0FBQztBQUNoRUEsT0FBTyx3Q0FBd0MsQ0FBQztBQUNoRCxJQUFJQyxpQkFBaUIsR0FBR0QsT0FBTyx3Q0FBd0MsQ0FBQztBQUN4RSxJQUFJRSxVQUFVLEdBQUdGLE9BQU8saUNBQWlDLENBQUM7QUFDMUQsSUFBSUcs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