cf3c2d596b3c525b16f140636f0cc98c
'use strict';

var UI = require("../../document/UI.js");
require("../../utils/dataTransfer/Clipboard.js");
var cursor = require("../../utils/focus/cursor.js");
var selection = require("../../utils/focus/selection.js");
var setSelection = require("./setSelection.js");

/**
 * Move the selection
 */
function moveSelection(node, direction) {
  // TODO: implement shift
  if (selection.hasOwnSelection(node)) {
    const selection = UI.getUISelection(node);
    setSelection.setSelection({
      focusNode: node,
      focusOffset: selection.startOffset === selection.endOffset ? selection.focusOffset + direction : direction < 0 ? selection.startOffset : selection.endOffset
    });
  } else {
    const selection = node.ownerDocument.getSelection();
    if (!(selection === null || selection === undefined ? undefined : selection.focusNode)) {
      return;
    }
    if (selection.isCollapsed) {
      const nextPosition = cursor.getNextCursorPosition(selection.focusNode, selection.focusOffset, direction);
      if (nextPosition) {
        setSelection.setSelection({
          focusNode: nextPosition.node,
          focusOffset: nextPosition.offset
        });
      }
    } else {
      selection[direction < 0 ? 'collapseToStart' : 'collapseToEnd']();
    }
  }
}
exports.moveSelection = moveSelection;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVSSIsInJlcXVpcmUiLCJjdXJzb3IiLCJzZWxlY3Rpb24iLCJzZXRTZWxlY3Rpb24iLCJtb3ZlU2VsZWN0aW9uIiwibm9kZSIsImRpcmVjdGlvbiIsImhhc093blNlbGVjdGlvbiIsImdldFVJU2VsZWN0aW9uIiwiZm9jdXNOb2RlIiwiZm9jdXNPZmZzZXQiLCJzdGFydE9mZnNldCIsImVuZE9mZnNldCIsIm93bmVyRG9jdW1lbnQiLCJnZXRTZWxlY3Rpb24iLCJ1bmRlZmluZWQiLCJpc0NvbGxhcHNlZCIsIm5leHRQb3NpdGlvbiIsImdldE5leHRDdXJzb3JQb3NpdGlvbiIsIm9mZnNldCIsImV4cG9ydHMiXSwic291cmNlcyI6WyJtb3ZlU2VsZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxudmFyIFVJID0gcmVxdWlyZSgnLi4vLi4vZG9jdW1lbnQvVUkuanMnKTtcbnJlcXVpcmUoJy4uLy4uL3V0aWxzL2RhdGFUcmFuc2Zlci9DbGlwYm9hcmQuanMnKTtcbnZhciBjdXJzb3IgPSByZXF1aXJlKCcuLi8uLi91dGlscy9mb2N1cy9jdXJzb3IuanMnKTtcbnZhciBzZWxlY3Rpb24gPSByZXF1aXJlKCcuLi8uLi91dGlscy9mb2N1cy9zZWxlY3Rpb24uanMnKTtcbnZhciBzZXRTZWxlY3Rpb24gPSByZXF1aXJlKCcuL3NldFNlbGVjdGlvbi5qcycpO1xuXG4vKipcbiAqIE1vdmUgdGhlIHNlbGVjdGlvblxuICovIGZ1bmN0aW9uIG1vdmVTZWxlY3Rpb24obm9kZSwgZGlyZWN0aW9uKSB7XG4gICAgLy8gVE9ETzogaW1wbGVtZW50IHNoaWZ0XG4gICAgaWYgKHNlbGVjdGlvbi5oYXNPd25TZWxlY3Rpb24obm9kZSkpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0aW9uID0gVUkuZ2V0VUlTZWxlY3Rpb24obm9kZSk7XG4gICAgICAgIHNldFNlbGVjdGlvbi5zZXRTZWxlY3Rpb24oe1xuICAgICAgICAgICAgZm9jdXNOb2RlOiBub2RlLFxuICAgICAgICAgICAgZm9jdXNPZmZzZXQ6IHNlbGVjdGlvbi5zdGFydE9mZnNldCA9PT0gc2VsZWN0aW9uLmVuZE9mZnNldCA/IHNlbGVjdGlvbi5mb2N1c09mZnNldCArIGRpcmVjdGlvbiA6IGRpcmVjdGlvbiA8IDAgPyBzZWxlY3Rpb24uc3RhcnRPZmZzZXQgOiBzZWxlY3Rpb24uZW5kT2Zmc2V0XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IG5vZGUub3duZXJEb2N1bWVudC5nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgaWYgKCEoc2VsZWN0aW9uID09PSBudWxsIHx8IHNlbGVjdGlvbiA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogc2VsZWN0aW9uLmZvY3VzTm9kZSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZWN0aW9uLmlzQ29sbGFwc2VkKSB7XG4gICAgICAgICAgICBjb25zdCBuZXh0UG9zaXRpb24gPSBjdXJzb3IuZ2V0TmV4dEN1cnNvclBvc2l0aW9uKHNlbGVjdGlvbi5mb2N1c05vZGUsIHNlbGVjdGlvbi5mb2N1c09mZnNldCwgZGlyZWN0aW9uKTtcbiAgICAgICAgICAgIGlmIChuZXh0UG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICBzZXRTZWxlY3Rpb24uc2V0U2VsZWN0aW9uKHtcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNOb2RlOiBuZXh0UG9zaXRpb24ubm9kZSxcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNPZmZzZXQ6IG5leHRQb3NpdGlvbi5vZmZzZXRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNlbGVjdGlvbltkaXJlY3Rpb24gPCAwID8gJ2NvbGxhcHNlVG9TdGFydCcgOiAnY29sbGFwc2VUb0VuZCddKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydHMubW92ZVNlbGVjdGlvbiA9IG1vdmVTZWxlY3Rpb247XG4iXSwibWFwcGluZ3MiOiJBQUFBLFlBQVk7O0FBRVosSUFBSUEsRUFBRSxHQUFHQyxPQUFPLHVCQUF1QixDQUFDO0FBQ3hDQSxPQUFPLHdDQUF3QyxDQUFDO0FBQ2hELElBQUlDLE1BQU0sR0FBR0QsT0FBTyw4QkFBOEIsQ0FBQztBQUNuRCxJQUFJRSxTQUFTLEdBQUdGLE9BQU8saUNBQWlDLENBQUM7QUFDekQsSUFBSUcsWUFBWSxHQUFHSCxPQUFPLG9CQUFvQixDQUFDOztBQUUvQztBQUNBO0FBQ0E7QUFBSSxTQUFTSSxhQUFhQSxDQUFDQyxJQUFJLEVBQUVDLFNBQVMsRUFBRTtFQUN4QztFQUNBLElBQUlKLFNBQVMsQ0FBQ0ssZUFBZSxDQUFDRixJQUFJLENBQUMsRUFBRTtJQUNqQyxNQUFNSCxTQUFTLEdBQUdILEVBQUUsQ0FBQ1MsY0FBYyxDQUFDSCxJQUFJLENBQUM7SUFDekNGLFlBQVksQ0FBQ0EsWUFBWSxDQUFDO01BQ3RCTSxTQUFTLEVBQUVKLElBQUk7TUFDZkssV0FBVyxFQUFFUixTQUFTLENBQUNTLFdBQVcsS0FBS1QsU0FBUyxDQUFDVSxTQUFTLEdBQUdWLFNBQVMsQ0FBQ1EsV0FBVyxHQUFHSixTQUFTLEdBQUdBLFNBQVMsR0FBRyxDQUFDLEdBQUdKLFNBQVMsQ0FBQ1MsV0FBVyxHQUFHVCxTQUFTLENBQUNVO0lBQ3ZKLENBQUMsQ0FBQztFQUNOLENBQUMsTUFBTTtJQUNILE1BQU1WLFNBQVMsR0FBR0csSUFBSSxDQUFDUSxhQUFhLENBQUNDLFlBQVksQ0FBQyxDQUFDO0lBQ25ELElBQUksRUFBRVosU0FBUyxLQUFLLElBQUksSUFBSUEsU0FBUyxLQUFLYSxTQUFTLEdBQUdBLFNBQVMsR0FBR2IsU0FBUyxDQUFDTyxTQUFTLENBQUMsRUFBRTtNQUNwRjtJQUNKO0lBQ0EsSUFBSVAsU0FBUyxDQUFDYyxXQUFXLEVBQUU7TUFDdkIsTUFBTUMsWUFBWSxHQUFHaEIsTUFBTSxDQUFDaUIscUJBQXFCLENBQUNoQixTQUFTLENBQUNPLFNBQVMsRUFBRVAsU0FBUyxDQUFDUSxXQUFXLEVBQUVKLFNBQVMsQ0FBQztNQUN4RyxJQUFJVyxZQUFZLEVBQUU7UUFDZGQsWUFBWSxDQUFDQSxZQUFZLENBQUM7VUFDdEJNLFNBQVMsRUFBRVEsWUFBWSxDQUFDWixJQUFJO1VBQzVCSyxXQUFXLEVBQUVPLFlBQVksQ0FBQ0U7UUFDOUIsQ0FBQyxDQUFDO01BQ047SUFDSixDQUFDLE1BQU07TUFDSGpCLFNBQVMsQ0FBQ0ksU0FBUyxHQUFHLENBQUMsR0FBRyxpQkFBaUIsR0FBRyxlQUFlLENBQUMsQ0FBQyxDQUFDO0lBQ3BFO0VBQ0o7QUFDSjtBQUVBYyxPQUFPLENBQUNoQixhQUFhLEdBQUdBLGFBQWEiLCJpZ25vcmVMaXN0IjpbXX0=