{"version":3,"names":["_api","_interopRequireDefault","require","_booleanHelper","_createLogger","e","__esModule","default","ParametreService","constructor","getAllParametres","bind","getParametre","updateParametre","normalizeParametreValue","normalizeParametresGroup","prepareParametreForApi","log","createLogger","value","type","undefined","toLowerCase","toBoolean","parseInt","parseFloat","String","parametresGroup","Array","isArray","debug","length","map","param","normalized","valeurParametre","typeParametre","normalizeBooleanFields","key","parametre","Object","entries","result","nomParametre","parametreData","prepared","toBooleanString","Actif","Obligatoire","Visible","response","api","get","success","parametres","parametresNormalises","groupeName","groupeData","message","error","groupe","sGroupe","categorie","params","parametreNormalise","dataToSend","post","isParametreActive","toggleParametreBoolean","activer","groupeParametre","sousGroupeParametre","_default","exports"],"sources":["ParametreService.js"],"sourcesContent":["/**\r\n * Service de gestion des paramètres - VERSION CORRIGÉE\r\n * ✅ Reprend la dernière version du repository\r\n * ✅ Utilise correctement le booleanHelper pour normaliser seulement les champs booléens\r\n * @class ParametreService\r\n * @description Gère l'accès aux données des paramètres via l'API\r\n */\r\nimport api from './api';\r\nimport { toBoolean, toBooleanString, normalizeBooleanFields } from '../utils/booleanHelper';\r\nimport { createLogger } from '../utils/createLogger';\r\n\r\nclass ParametreService {\r\n  constructor() {\r\n    // Bind des méthodes\r\n    this.getAllParametres = this.getAllParametres.bind(this);\r\n    this.getParametre = this.getParametre.bind(this);\r\n    this.updateParametre = this.updateParametre.bind(this);\r\n    this.normalizeParametreValue = this.normalizeParametreValue.bind(this);\r\n    this.normalizeParametresGroup = this.normalizeParametresGroup.bind(this);\r\n    this.prepareParametreForApi = this.prepareParametreForApi.bind(this);\r\n\r\n    this.log = createLogger('ParametreService');\r\n\r\n  }\r\n\r\n  /**\r\n   * ✅ NORMALISE LA VALEUR D'UN PARAMÈTRE SELON SON TYPE\r\n   * Respecte le type du paramètre déclaré :\r\n   * - boolean : convertit en booléen via toBoolean()\r\n   * - number/int/float : convertit en nombre\r\n   * - string/text (défaut) : conserve comme chaîne SANS conversion automatique\r\n   * \r\n   * @param {any} value - Valeur à normaliser\r\n   * @param {string} type - Type du paramètre ('boolean', 'string', 'number', etc.)\r\n   * @returns {any} - Valeur normalisée\r\n   */\r\n  normalizeParametreValue(value, type = 'string') {\r\n    if (value === null || value === undefined) {\r\n      return value;\r\n    }\r\n\r\n    switch (type?.toLowerCase()) {\r\n      case 'boolean':\r\n      case 'bool':\r\n        // ✅ Convertir explicitement en booléen seulement si le type est boolean\r\n        return toBoolean(value);\r\n      \r\n      case 'number':\r\n      case 'int':\r\n      case 'integer':\r\n        return parseInt(value) || 0;\r\n      \r\n      case 'float':\r\n      case 'double':\r\n        return parseFloat(value) || 0;\r\n      \r\n      case 'string':\r\n      case 'text':\r\n      default:\r\n        // ✅ CORRECTION: Conserver la valeur comme chaîne SANS conversion automatique\r\n        // Les valeurs \"0\" et \"1\" restent des chaînes, pas des booléens\r\n        return String(value);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ✅ NORMALISE UN GROUPE DE PARAMÈTRES - VERSION CORRIGÉE\r\n   * Utilise le booleanHelper pour normaliser sélectivement les propriétés booléennes\r\n   * \r\n   * @param {Object} parametresGroup - Groupe de paramètres à normaliser\r\n   * @returns {Object} - Groupe avec valeurs normalisées\r\n   */\r\n  normalizeParametresGroup(parametresGroup) {\r\n    if (!parametresGroup || typeof parametresGroup !== 'object') {\r\n      return parametresGroup;\r\n    }\r\n\r\n    // Traiter les tableaux de paramètres\r\n    if (Array.isArray(parametresGroup)) {\r\n      this.log.debug('✅ normalizeParametresGroup - Traitement tableau:', parametresGroup.length, 'éléments');\r\n      \r\n      return parametresGroup.map(param => {\r\n        if (param && typeof param === 'object') {\r\n          // ✅ Normaliser la valeur selon son type déclaré\r\n          const normalized = {\r\n            ...param,\r\n            valeurParametre: this.normalizeParametreValue(\r\n              param.valeurParametre, \r\n              param.typeParametre || param.type\r\n            )\r\n          };\r\n\r\n          // ✅ Utiliser normalizeBooleanFields pour les propriétés métadonnées\r\n          // Ces champs sont TOUJOURS des booléens\r\n          return normalizeBooleanFields(normalized, ['Actif', 'Obligatoire', 'Visible']);\r\n        }\r\n        return param;\r\n      });\r\n    }\r\n\r\n    // Traiter les objets imbriqués récursivement\r\n    const normalized = {};\r\n    \r\n    for (const [key, parametre] of Object.entries(parametresGroup)) {\r\n      if (Array.isArray(parametre)) {\r\n        this.log.debug(`✅ Traitement tableau pour ${key}:`, parametre.length, 'éléments');\r\n        \r\n        normalized[key] = parametre.map(param => {\r\n          if (param && typeof param === 'object') {\r\n            const result = {\r\n              ...param,\r\n              valeurParametre: this.normalizeParametreValue(\r\n                param.valeurParametre, \r\n                param.typeParametre || param.type\r\n              )\r\n            };\r\n            return normalizeBooleanFields(result, ['Actif', 'Obligatoire', 'Visible']);\r\n          }\r\n          return param;\r\n        });\r\n      } \r\n      else if (parametre && typeof parametre === 'object' && parametre.nomParametre) {\r\n        // Paramètre direct (pas imbriqué)\r\n        normalized[key] = {\r\n          ...parametre,\r\n          valeurParametre: this.normalizeParametreValue(\r\n            parametre.valeurParametre, \r\n            parametre.typeParametre || parametre.type\r\n          )\r\n        };\r\n        normalized[key] = normalizeBooleanFields(normalized[key], ['Actif', 'Obligatoire', 'Visible']);\r\n      } \r\n      else if (parametre && typeof parametre === 'object') {\r\n        // Conteneur - traiter récursivement\r\n        normalized[key] = this.normalizeParametresGroup(parametre);\r\n      } \r\n      else {\r\n        // Autres types - garder tel quel\r\n        normalized[key] = parametre;\r\n      }\r\n    }\r\n\r\n    return normalized;\r\n  }\r\n\r\n  /**\r\n   * ✅ PRÉPARE UN PARAMÈTRE POUR L'ENVOI À L'API\r\n   * Convertit les booléens en chaînes pour transmission\r\n   * \r\n   * @param {Object} parametreData - Données du paramètre\r\n   * @returns {Object} - Données préparées pour l'API\r\n   */\r\n  prepareParametreForApi(parametreData) {\r\n    // ✅ CORRECTION: Utiliser let au lieu de const pour pouvoir réassigner\r\n    let prepared = { ...parametreData };\r\n\r\n    // Convertir les booléens en chaînes pour l'API si nécessaire\r\n    if (typeof prepared.valeurParametre === 'boolean') {\r\n      prepared.valeurParametre = toBooleanString(prepared.valeurParametre);\r\n      this.log.debug('✅ Conversion booléen → chaîne pour API:', \r\n        parametreData.valeurParametre, '→', prepared.valeurParametre);\r\n    }\r\n\r\n    // ✅ Normaliser les propriétés booléennes métadonnées\r\n    prepared = normalizeBooleanFields(prepared, ['Actif', 'Obligatoire', 'Visible']);\r\n    \r\n    // Convertir les propriétés booléennes en chaînes pour l'API\r\n    if (prepared.Actif !== undefined && typeof prepared.Actif === 'boolean') {\r\n      prepared.Actif = toBooleanString(prepared.Actif);\r\n    }\r\n    if (prepared.Obligatoire !== undefined && typeof prepared.Obligatoire === 'boolean') {\r\n      prepared.Obligatoire = toBooleanString(prepared.Obligatoire);\r\n    }\r\n    if (prepared.Visible !== undefined && typeof prepared.Visible === 'boolean') {\r\n      prepared.Visible = toBooleanString(prepared.Visible);\r\n    }\r\n\r\n    return prepared;\r\n  }\r\n\r\n  /**\r\n   * Récupère tous les paramètres de tous les groupes\r\n   * @returns {Promise<Object>} Structure complète des paramètres avec valeurs normalisées\r\n   */\r\n  async getAllParametres() {\r\n    try {\r\n      const response = await api.get('parametre-api.php?tousGroupes=true');\r\n      \r\n      if (response && response.success) {\r\n        const parametres = response.parametres || {};\r\n        \r\n        // ✅ NORMALISATION DE TOUS LES GROUPES DE PARAMÈTRES\r\n        const parametresNormalises = {};\r\n        \r\n        for (const [groupeName, groupeData] of Object.entries(parametres)) {\r\n          this.log.debug(`✅ Normalisation du groupe: ${groupeName}`);\r\n          \r\n          if (groupeData && typeof groupeData === 'object') {\r\n            parametresNormalises[groupeName] = this.normalizeParametresGroup(groupeData);\r\n          } else {\r\n            parametresNormalises[groupeName] = groupeData;\r\n          }\r\n        }\r\n        \r\n        this.log.debug('✅ Paramètres avant normalisation:', parametres);\r\n        this.log.debug('✅ Paramètres après normalisation:', parametresNormalises);\r\n        \r\n        return {\r\n          success: true,\r\n          parametres: parametresNormalises\r\n        };\r\n      }\r\n      \r\n      return {\r\n        success: false,\r\n        message: response?.message || 'Erreur lors de la récupération des paramètres'\r\n      };\r\n    } catch (error) {\r\n      this.log.error('Erreur lors du chargement des paramètres:', error);\r\n      return {\r\n        success: false,\r\n        message: error.message || 'Erreur lors de la récupération des paramètres'\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Récupère un paramètre spécifique avec normalisation\r\n   * @param {string} nomParametre Nom du paramètre\r\n   * @param {string} groupe Groupe du paramètre\r\n   * @param {string} [sGroupe] Sous-groupe du paramètre\r\n   * @param {string} [categorie] Catégorie du paramètre\r\n   * @returns {Promise<Object>} Détails du paramètre avec valeur normalisée\r\n   */\r\n  async getParametre(nomParametre, groupe, sGroupe = null, categorie = null) {\r\n    try {\r\n      const params = {\r\n        nomParametre: nomParametre,\r\n        groupe: groupe\r\n      };\r\n      \r\n      if (sGroupe) {\r\n        params.sGroupe = sGroupe;\r\n      }\r\n      \r\n      if (categorie) {\r\n        params.categorie = categorie;\r\n      }\r\n      \r\n      const response = await api.get('parametre-api.php', params);\r\n      \r\n      if (response && response.success) {\r\n        const parametre = response.parametre || {};\r\n        \r\n        // ✅ NORMALISATION DU PARAMÈTRE INDIVIDUEL\r\n        const parametreNormalise = {\r\n          ...parametre,\r\n          valeurParametre: this.normalizeParametreValue(\r\n            parametre.valeurParametre,\r\n            parametre.typeParametre || parametre.type\r\n          )\r\n        };\r\n        \r\n        // ✅ Normaliser les propriétés booléennes métadonnées\r\n        const result = normalizeBooleanFields(parametreNormalise, ['Actif', 'Obligatoire', 'Visible']);\r\n        \r\n        this.log.debug('✅ Paramètre avant normalisation:', parametre);\r\n        this.log.debug('✅ Paramètre après normalisation:', result);\r\n        \r\n        return {\r\n          success: true,\r\n          parametre: result\r\n        };\r\n      }\r\n      \r\n      return {\r\n        success: false,\r\n        message: response?.message || 'Paramètre non trouvé'\r\n      };\r\n    } catch (error) {\r\n      this.log.error(`Erreur lors de la récupération du paramètre ${nomParametre}:`, error);\r\n      return {\r\n        success: false,\r\n        message: error.message || 'Erreur lors de la récupération du paramètre'\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Met à jour un paramètre avec gestion des booléens\r\n   * @param {Object} parametreData Données du paramètre à mettre à jour\r\n   * @returns {Promise<Object>} Résultat de la mise à jour\r\n   */\r\n  async updateParametre(parametreData) {\r\n    try {\r\n      this.log.debug('✅ Données d\\'entrée pour mise à jour:', parametreData);\r\n      \r\n      // ✅ PRÉPARATION DES DONNÉES AVEC GESTION DES BOOLÉENS\r\n      let dataToSend = this.prepareParametreForApi(parametreData);\r\n      \r\n      this.log.debug('✅ Données préparées pour l\\'API:', dataToSend);\r\n      const response = await api.post('parametre-api.php', dataToSend);\r\n      \r\n      return {\r\n        success: response?.success || false,\r\n        message: response?.message || 'Mise à jour effectuée'\r\n      };\r\n    } catch (error) {\r\n      this.log.error('Erreur lors de la mise à jour du paramètre:', error);\r\n      return {\r\n        success: false,\r\n        message: error.message || 'Erreur lors de la mise à jour du paramètre'\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ✅ MÉTHODES UTILITAIRES POUR LES PARAMÈTRES BOOLÉENS\r\n   */\r\n\r\n  /**\r\n   * Vérifie si un paramètre booléen est activé\r\n   * @param {string} nomParametre Nom du paramètre\r\n   * @param {string} groupe Groupe du paramètre\r\n   * @param {string} [sGroupe] Sous-groupe du paramètre\r\n   * @returns {Promise<boolean>} True si le paramètre est activé\r\n   */\r\n  async isParametreActive(nomParametre, groupe, sGroupe = null) {\r\n    try {\r\n      const result = await this.getParametre(nomParametre, groupe, sGroupe);\r\n      \r\n      if (result.success && result.parametre) {\r\n        return toBoolean(result.parametre.valeurParametre);\r\n      }\r\n      \r\n      return false;\r\n    } catch (error) {\r\n      this.log.error(`Erreur lors de la vérification du paramètre ${nomParametre}:`, error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Active ou désactive un paramètre booléen\r\n   * @param {string} nomParametre Nom du paramètre\r\n   * @param {string} groupe Groupe du paramètre\r\n   * @param {string} sGroupe Sous-groupe du paramètre\r\n   * @param {boolean} activer True pour activer, false pour désactiver\r\n   * @returns {Promise<Object>} Résultat de la mise à jour\r\n   */\r\n  async toggleParametreBoolean(nomParametre, groupe, sGroupe, activer) {\r\n    try {\r\n      const parametreData = {\r\n        nomParametre: nomParametre,\r\n        groupeParametre: groupe,\r\n        sousGroupeParametre: sGroupe,\r\n        valeurParametre: activer\r\n      };\r\n      \r\n      return await this.updateParametre(parametreData);\r\n    } catch (error) {\r\n      this.log.error(`Erreur lors du toggle du paramètre ${nomParametre}:`, error);\r\n      return {\r\n        success: false,\r\n        message: error.message || 'Erreur lors de la mise à jour du paramètre'\r\n      };\r\n    }\r\n  }\r\n}\r\n\r\nexport default ParametreService;"],"mappings":"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","ignoreList":[]}