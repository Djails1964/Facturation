7b378bb7111b26407aeb43a9326f6284
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useFactureForm = exports.default = void 0;
var _react = require("react");
var _factureConstants = require("../../../constants/factureConstants");
// src/components/factures/hooks/useFactureForm.js
// ✅ VERSION REFACTORISÉE - Ne crée plus de services en interne
// ✅ Les appels API passent par useFactureActions et useTarifActions

/**
 * Hook principal pour la gestion de l'état du formulaire de facture
 * ✅ REFACTORISÉ: Ne crée plus de services en interne
 * ✅ Les composants utilisent useFactureFormActions pour les opérations API
 * 
 * @param {string} mode - Mode du formulaire (VIEW, CREATE, EDIT)
 * @param {string|number} idFacture - ID de la facture (null pour création)
 * @returns {Object} État et fonctions du formulaire
 */
const useFactureForm = (mode, idFacture) => {
  // États principaux
  const [facture, setFacture] = (0, _react.useState)({
    idFacture: '',
    numeroFacture: '',
    dateFacture: '',
    idClient: null,
    montantTotal: 0,
    ristourne: 0,
    totalAvecRistourne: 0,
    lignes: [],
    etat: '',
    documentPath: null,
    date_annulation: null,
    date_paiement: null
  });
  const [isLoading, setIsLoading] = (0, _react.useState)(idFacture !== null);
  const [isSubmitting, setIsSubmitting] = (0, _react.useState)(false);
  const [error, setError] = (0, _react.useState)(null);
  const [clientData, setClientData] = (0, _react.useState)(null);
  const [clientLoading, setClientLoading] = (0, _react.useState)(false);
  const [isLignesValid, setIsLignesValid] = (0, _react.useState)(false);

  // Utilitaires
  const isReadOnly = mode === _factureConstants.FORM_MODES.VIEW;
  const isFormValid = mode === _factureConstants.FORM_MODES.VIEW || facture.numeroFacture && facture.idClient && facture.lignes && facture.lignes.length > 0 && isLignesValid;

  // Fonction pour obtenir les données du formulaire avec mémorisation
  const getFormData = (0, _react.useCallback)(() => {
    return {
      numeroFacture: facture.numeroFacture,
      dateFacture: facture.dateFacture,
      idClient: facture.idClient,
      lignes: facture.lignes,
      ristourne: facture.ristourne,
      montantTotal: facture.montantTotal,
      totalAvecRistourne: facture.totalAvecRistourne
    };
  }, [facture]);
  return {
    // États
    facture,
    setFacture,
    isLoading,
    setIsLoading,
    isSubmitting,
    setIsSubmitting,
    error,
    setError,
    clientData,
    setClientData,
    clientLoading,
    setClientLoading,
    isLignesValid,
    setIsLignesValid,
    // ✅ Plus de services retournés - utiliser useFactureFormActions

    // Utilitaires
    isReadOnly,
    isFormValid,
    getFormData
  };
};
exports.useFactureForm = useFactureForm;
var _default = exports.default = useFactureForm;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX2ZhY3R1cmVDb25zdGFudHMiLCJ1c2VGYWN0dXJlRm9ybSIsIm1vZGUiLCJpZEZhY3R1cmUiLCJmYWN0dXJlIiwic2V0RmFjdHVyZSIsInVzZVN0YXRlIiwibnVtZXJvRmFjdHVyZSIsImRhdGVGYWN0dXJlIiwiaWRDbGllbnQiLCJtb250YW50VG90YWwiLCJyaXN0b3VybmUiLCJ0b3RhbEF2ZWNSaXN0b3VybmUiLCJsaWduZXMiLCJldGF0IiwiZG9jdW1lbnRQYXRoIiwiZGF0ZV9hbm51bGF0aW9uIiwiZGF0ZV9wYWllbWVudCIsImlzTG9hZGluZyIsInNldElzTG9hZGluZyIsImlzU3VibWl0dGluZyIsInNldElzU3VibWl0dGluZyIsImVycm9yIiwic2V0RXJyb3IiLCJjbGllbnREYXRhIiwic2V0Q2xpZW50RGF0YSIsImNsaWVudExvYWRpbmciLCJzZXRDbGllbnRMb2FkaW5nIiwiaXNMaWduZXNWYWxpZCIsInNldElzTGlnbmVzVmFsaWQiLCJpc1JlYWRPbmx5IiwiRk9STV9NT0RFUyIsIlZJRVciLCJpc0Zvcm1WYWxpZCIsImxlbmd0aCIsImdldEZvcm1EYXRhIiwidXNlQ2FsbGJhY2siLCJleHBvcnRzIiwiX2RlZmF1bHQiLCJkZWZhdWx0Il0sInNvdXJjZXMiOlsidXNlRmFjdHVyZUZvcm0uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL2NvbXBvbmVudHMvZmFjdHVyZXMvaG9va3MvdXNlRmFjdHVyZUZvcm0uanNcclxuLy8g4pyFIFZFUlNJT04gUkVGQUNUT1JJU8OJRSAtIE5lIGNyw6llIHBsdXMgZGUgc2VydmljZXMgZW4gaW50ZXJuZVxyXG4vLyDinIUgTGVzIGFwcGVscyBBUEkgcGFzc2VudCBwYXIgdXNlRmFjdHVyZUFjdGlvbnMgZXQgdXNlVGFyaWZBY3Rpb25zXHJcblxyXG5pbXBvcnQgeyB1c2VTdGF0ZSwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IEZPUk1fTU9ERVMgfSBmcm9tICcuLi8uLi8uLi9jb25zdGFudHMvZmFjdHVyZUNvbnN0YW50cyc7XHJcblxyXG4vKipcclxuICogSG9vayBwcmluY2lwYWwgcG91ciBsYSBnZXN0aW9uIGRlIGwnw6l0YXQgZHUgZm9ybXVsYWlyZSBkZSBmYWN0dXJlXHJcbiAqIOKchSBSRUZBQ1RPUklTw4k6IE5lIGNyw6llIHBsdXMgZGUgc2VydmljZXMgZW4gaW50ZXJuZVxyXG4gKiDinIUgTGVzIGNvbXBvc2FudHMgdXRpbGlzZW50IHVzZUZhY3R1cmVGb3JtQWN0aW9ucyBwb3VyIGxlcyBvcMOpcmF0aW9ucyBBUElcclxuICogXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBtb2RlIC0gTW9kZSBkdSBmb3JtdWxhaXJlIChWSUVXLCBDUkVBVEUsIEVESVQpXHJcbiAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gaWRGYWN0dXJlIC0gSUQgZGUgbGEgZmFjdHVyZSAobnVsbCBwb3VyIGNyw6lhdGlvbilcclxuICogQHJldHVybnMge09iamVjdH0gw4l0YXQgZXQgZm9uY3Rpb25zIGR1IGZvcm11bGFpcmVcclxuICovXHJcbmV4cG9ydCBjb25zdCB1c2VGYWN0dXJlRm9ybSA9IChtb2RlLCBpZEZhY3R1cmUpID0+IHtcclxuICAvLyDDiXRhdHMgcHJpbmNpcGF1eFxyXG4gIGNvbnN0IFtmYWN0dXJlLCBzZXRGYWN0dXJlXSA9IHVzZVN0YXRlKHtcclxuICAgIGlkRmFjdHVyZTogJycsXHJcbiAgICBudW1lcm9GYWN0dXJlOiAnJyxcclxuICAgIGRhdGVGYWN0dXJlOiAnJyxcclxuICAgIGlkQ2xpZW50OiBudWxsLFxyXG4gICAgbW9udGFudFRvdGFsOiAwLFxyXG4gICAgcmlzdG91cm5lOiAwLFxyXG4gICAgdG90YWxBdmVjUmlzdG91cm5lOiAwLFxyXG4gICAgbGlnbmVzOiBbXSxcclxuICAgIGV0YXQ6ICcnLFxyXG4gICAgZG9jdW1lbnRQYXRoOiBudWxsLFxyXG4gICAgZGF0ZV9hbm51bGF0aW9uOiBudWxsLFxyXG4gICAgZGF0ZV9wYWllbWVudDogbnVsbFxyXG4gIH0pO1xyXG5cclxuICBjb25zdCBbaXNMb2FkaW5nLCBzZXRJc0xvYWRpbmddID0gdXNlU3RhdGUoaWRGYWN0dXJlICE9PSBudWxsKTtcclxuICBjb25zdCBbaXNTdWJtaXR0aW5nLCBzZXRJc1N1Ym1pdHRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xyXG4gIGNvbnN0IFtlcnJvciwgc2V0RXJyb3JdID0gdXNlU3RhdGUobnVsbCk7XHJcbiAgY29uc3QgW2NsaWVudERhdGEsIHNldENsaWVudERhdGFdID0gdXNlU3RhdGUobnVsbCk7XHJcbiAgY29uc3QgW2NsaWVudExvYWRpbmcsIHNldENsaWVudExvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xyXG4gIGNvbnN0IFtpc0xpZ25lc1ZhbGlkLCBzZXRJc0xpZ25lc1ZhbGlkXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuXHJcbiAgLy8gVXRpbGl0YWlyZXNcclxuICBjb25zdCBpc1JlYWRPbmx5ID0gbW9kZSA9PT0gRk9STV9NT0RFUy5WSUVXO1xyXG4gIGNvbnN0IGlzRm9ybVZhbGlkID0gbW9kZSA9PT0gRk9STV9NT0RFUy5WSUVXIHx8XHJcbiAgICAoZmFjdHVyZS5udW1lcm9GYWN0dXJlICYmXHJcbiAgICAgIGZhY3R1cmUuaWRDbGllbnQgJiZcclxuICAgICAgZmFjdHVyZS5saWduZXMgJiZcclxuICAgICAgZmFjdHVyZS5saWduZXMubGVuZ3RoID4gMCAmJlxyXG4gICAgICBpc0xpZ25lc1ZhbGlkKTtcclxuXHJcbiAgLy8gRm9uY3Rpb24gcG91ciBvYnRlbmlyIGxlcyBkb25uw6llcyBkdSBmb3JtdWxhaXJlIGF2ZWMgbcOpbW9yaXNhdGlvblxyXG4gIGNvbnN0IGdldEZvcm1EYXRhID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbnVtZXJvRmFjdHVyZTogZmFjdHVyZS5udW1lcm9GYWN0dXJlLFxyXG4gICAgICBkYXRlRmFjdHVyZTogZmFjdHVyZS5kYXRlRmFjdHVyZSxcclxuICAgICAgaWRDbGllbnQ6IGZhY3R1cmUuaWRDbGllbnQsXHJcbiAgICAgIGxpZ25lczogZmFjdHVyZS5saWduZXMsXHJcbiAgICAgIHJpc3RvdXJuZTogZmFjdHVyZS5yaXN0b3VybmUsXHJcbiAgICAgIG1vbnRhbnRUb3RhbDogZmFjdHVyZS5tb250YW50VG90YWwsXHJcbiAgICAgIHRvdGFsQXZlY1Jpc3RvdXJuZTogZmFjdHVyZS50b3RhbEF2ZWNSaXN0b3VybmVcclxuICAgIH07XHJcbiAgfSwgW2ZhY3R1cmVdKTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIC8vIMOJdGF0c1xyXG4gICAgZmFjdHVyZSxcclxuICAgIHNldEZhY3R1cmUsXHJcbiAgICBpc0xvYWRpbmcsXHJcbiAgICBzZXRJc0xvYWRpbmcsXHJcbiAgICBpc1N1Ym1pdHRpbmcsXHJcbiAgICBzZXRJc1N1Ym1pdHRpbmcsXHJcbiAgICBlcnJvcixcclxuICAgIHNldEVycm9yLFxyXG4gICAgY2xpZW50RGF0YSxcclxuICAgIHNldENsaWVudERhdGEsXHJcbiAgICBjbGllbnRMb2FkaW5nLFxyXG4gICAgc2V0Q2xpZW50TG9hZGluZyxcclxuICAgIGlzTGlnbmVzVmFsaWQsXHJcbiAgICBzZXRJc0xpZ25lc1ZhbGlkLFxyXG4gICAgXHJcbiAgICAvLyDinIUgUGx1cyBkZSBzZXJ2aWNlcyByZXRvdXJuw6lzIC0gdXRpbGlzZXIgdXNlRmFjdHVyZUZvcm1BY3Rpb25zXHJcbiAgICBcclxuICAgIC8vIFV0aWxpdGFpcmVzXHJcbiAgICBpc1JlYWRPbmx5LFxyXG4gICAgaXNGb3JtVmFsaWQsXHJcbiAgICBnZXRGb3JtRGF0YVxyXG4gIH07XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCB1c2VGYWN0dXJlRm9ybTsiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUlBLElBQUFBLE1BQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLGlCQUFBLEdBQUFELE9BQUE7QUFMQTtBQUNBO0FBQ0E7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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