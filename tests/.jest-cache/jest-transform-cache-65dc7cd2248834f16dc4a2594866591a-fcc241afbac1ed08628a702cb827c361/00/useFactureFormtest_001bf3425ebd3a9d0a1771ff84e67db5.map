{"version":3,"names":["_react","require","_useFactureForm","describe","it","result","renderHook","useFactureForm","factureFormState","current","expect","facture","toEqual","idFacture","numeroFacture","dateFacture","any","String","dateEcheance","idClient","etat","lignes","ristourne","commentaire","isLoading","toBe","error","toBeNull","isModified","nouvelleFacture","createTestFacture","act","setFacture","updateFactureField","idLigne","idService","quantite","prixUnitaire","setLignes","setIsLoading","setError","resetForm","setIsModified","factureValide","toBeTruthy","length","toBeGreaterThan","factureIncomplete","montantTotal","f","totalNet"],"sources":["useFactureForm.test.js"],"sourcesContent":["// tests/unit/hooks/useFactureForm.test.js\r\n// Tests unitaires pour le hook useFactureForm\r\n\r\nimport { renderHook, act } from '@testing-library/react';\r\n\r\n// Import après les mocks\r\nimport { useFactureForm } from '@components/factures/hooks/useFactureForm';\r\n\r\ndescribe('useFactureForm', () => {\r\n  describe('État initial', () => {\r\n    it('devrait initialiser avec les valeurs par défaut', () => {\r\n      const { result } = renderHook(() => useFactureForm());\r\n      \r\n      const { factureFormState } = result.current;\r\n      \r\n      expect(factureFormState.facture).toEqual({\r\n        idFacture: null,\r\n        numeroFacture: '',\r\n        dateFacture: expect.any(String), // Date du jour\r\n        dateEcheance: '',\r\n        idClient: null,\r\n        etat: 'En attente',\r\n        lignes: [],\r\n        ristourne: 0,\r\n        commentaire: ''\r\n      });\r\n      \r\n      expect(factureFormState.isLoading).toBe(false);\r\n      expect(factureFormState.error).toBeNull();\r\n      expect(factureFormState.isModified).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('setFacture', () => {\r\n    it('devrait mettre à jour la facture complète', () => {\r\n      const { result } = renderHook(() => useFactureForm());\r\n      \r\n      const nouvelleFacture = createTestFacture();\r\n      \r\n      act(() => {\r\n        result.current.setFacture(nouvelleFacture);\r\n      });\r\n      \r\n      expect(result.current.factureFormState.facture).toEqual(nouvelleFacture);\r\n    });\r\n  });\r\n\r\n  describe('updateFactureField', () => {\r\n    it('devrait mettre à jour un champ spécifique', () => {\r\n      const { result } = renderHook(() => useFactureForm());\r\n      \r\n      act(() => {\r\n        result.current.updateFactureField('idClient', 5);\r\n      });\r\n      \r\n      expect(result.current.factureFormState.facture.idClient).toBe(5);\r\n    });\r\n\r\n    it('devrait marquer le formulaire comme modifié', () => {\r\n      const { result } = renderHook(() => useFactureForm());\r\n      \r\n      act(() => {\r\n        result.current.updateFactureField('ristourne', 10);\r\n      });\r\n      \r\n      expect(result.current.factureFormState.isModified).toBe(true);\r\n    });\r\n  });\r\n\r\n  describe('setLignes', () => {\r\n    it('devrait mettre à jour les lignes de la facture', () => {\r\n      const { result } = renderHook(() => useFactureForm());\r\n      \r\n      const lignes = [\r\n        { idLigne: 1, idService: 1, quantite: 2, prixUnitaire: 100 },\r\n        { idLigne: 2, idService: 2, quantite: 1, prixUnitaire: 200 }\r\n      ];\r\n      \r\n      act(() => {\r\n        result.current.setLignes(lignes);\r\n      });\r\n      \r\n      expect(result.current.factureFormState.facture.lignes).toEqual(lignes);\r\n    });\r\n  });\r\n\r\n  describe('setIsLoading', () => {\r\n    it('devrait mettre à jour l\\'état de chargement', () => {\r\n      const { result } = renderHook(() => useFactureForm());\r\n      \r\n      act(() => {\r\n        result.current.setIsLoading(true);\r\n      });\r\n      \r\n      expect(result.current.factureFormState.isLoading).toBe(true);\r\n      \r\n      act(() => {\r\n        result.current.setIsLoading(false);\r\n      });\r\n      \r\n      expect(result.current.factureFormState.isLoading).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('setError', () => {\r\n    it('devrait définir une erreur', () => {\r\n      const { result } = renderHook(() => useFactureForm());\r\n      \r\n      act(() => {\r\n        result.current.setError('Une erreur est survenue');\r\n      });\r\n      \r\n      expect(result.current.factureFormState.error).toBe('Une erreur est survenue');\r\n    });\r\n\r\n    it('devrait effacer une erreur', () => {\r\n      const { result } = renderHook(() => useFactureForm());\r\n      \r\n      act(() => {\r\n        result.current.setError('Une erreur');\r\n        result.current.setError(null);\r\n      });\r\n      \r\n      expect(result.current.factureFormState.error).toBeNull();\r\n    });\r\n  });\r\n\r\n  describe('resetForm', () => {\r\n    it('devrait réinitialiser le formulaire', () => {\r\n      const { result } = renderHook(() => useFactureForm());\r\n      \r\n      // Modifier le formulaire\r\n      act(() => {\r\n        result.current.updateFactureField('idClient', 5);\r\n        result.current.updateFactureField('ristourne', 100);\r\n        result.current.setError('Une erreur');\r\n      });\r\n      \r\n      // Réinitialiser\r\n      act(() => {\r\n        result.current.resetForm();\r\n      });\r\n      \r\n      expect(result.current.factureFormState.facture.idClient).toBeNull();\r\n      expect(result.current.factureFormState.facture.ristourne).toBe(0);\r\n      expect(result.current.factureFormState.error).toBeNull();\r\n      expect(result.current.factureFormState.isModified).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('setIsModified', () => {\r\n    it('devrait permettre de définir manuellement isModified', () => {\r\n      const { result } = renderHook(() => useFactureForm());\r\n      \r\n      act(() => {\r\n        result.current.setIsModified(true);\r\n      });\r\n      \r\n      expect(result.current.factureFormState.isModified).toBe(true);\r\n      \r\n      act(() => {\r\n        result.current.setIsModified(false);\r\n      });\r\n      \r\n      expect(result.current.factureFormState.isModified).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('Validation des données', () => {\r\n    it('devrait valider une facture complète', () => {\r\n      const { result } = renderHook(() => useFactureForm());\r\n      \r\n      const factureValide = createTestFacture();\r\n      \r\n      act(() => {\r\n        result.current.setFacture(factureValide);\r\n      });\r\n      \r\n      // La facture devrait être considérée comme valide\r\n      const { facture } = result.current.factureFormState;\r\n      expect(facture.idClient).toBeTruthy();\r\n      expect(facture.dateFacture).toBeTruthy();\r\n      expect(facture.lignes.length).toBeGreaterThan(0);\r\n    });\r\n\r\n    it('devrait détecter une facture incomplète', () => {\r\n      const { result } = renderHook(() => useFactureForm());\r\n      \r\n      // Facture sans client\r\n      const factureIncomplete = {\r\n        ...createTestFacture(),\r\n        idClient: null,\r\n        lignes: []\r\n      };\r\n      \r\n      act(() => {\r\n        result.current.setFacture(factureIncomplete);\r\n      });\r\n      \r\n      const { facture } = result.current.factureFormState;\r\n      expect(facture.idClient).toBeNull();\r\n      expect(facture.lignes.length).toBe(0);\r\n    });\r\n  });\r\n\r\n  describe('Calculs automatiques', () => {\r\n    it('devrait calculer le total avec ristourne', () => {\r\n      const { result } = renderHook(() => useFactureForm());\r\n      \r\n      const facture = createTestFacture({\r\n        montantTotal: 1000,\r\n        ristourne: 100\r\n      });\r\n      \r\n      act(() => {\r\n        result.current.setFacture(facture);\r\n      });\r\n      \r\n      const { facture: f } = result.current.factureFormState;\r\n      const totalNet = f.montantTotal - f.ristourne;\r\n      expect(totalNet).toBe(900);\r\n    });\r\n  });\r\n});"],"mappings":"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","ignoreList":[]}