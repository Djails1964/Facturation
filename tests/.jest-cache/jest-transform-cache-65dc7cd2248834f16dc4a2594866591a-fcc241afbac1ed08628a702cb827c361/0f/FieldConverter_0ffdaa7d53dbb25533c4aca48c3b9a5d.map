{"version":3,"names":["_createLogger","require","log","createLogger","FieldConverter","FRONTEND_TO_API","dateDebut","dateFin","numeroFacture","montantTotal","idService","idUnite","typeTarifId","clientId","tarifId","prenomClient","nomClient","emailClient","isDefault","isActif","createdAt","updatedAt","API_TO_FRONTEND","Object","fromEntries","entries","map","key","value","toApiFormat","data","options","excludeFields","customMapping","preserveUnknown","warn","mapping","converted","keys","forEach","includes","apiKey","debug","original","filter","k","hasOwnProperty","toFrontendFormat","frontendKey","convertArray","dataArray","direction","Array","isArray","converter","item","convertTarifFormData","formData","tarifMapping","prixUnitaire","prixTotal","quantiteFacturee","v","convertClientData","clientData","clientMapping","adresseLigne1","adresseLigne2","codePostal","numeroTelephone","addMappings","newMappings","assign","newApiToFrontend","hasMappingFor","fieldName","getMappedName","debugMappings","group","groupEnd","exports","_default","default"],"sources":["FieldConverter.js"],"sourcesContent":["// utils/FieldConverter.js - Helper centralis√© pour conversion des noms de champs\r\n\r\nimport { createLogger } from './createLogger';\r\n\r\nconst log = createLogger('FieldConverter');\r\n\r\n/**\r\n * Service centralis√© pour convertir les noms de champs entre frontend et API\r\n * G√®re les conversions camelCase ‚Üî snake_case de mani√®re coh√©rente\r\n */\r\nexport class FieldConverter {\r\n  \r\n  // ================================\r\n  // MAPPINGS DE CONVERSION\r\n  // ================================\r\n  \r\n  /**\r\n   * Mapping camelCase ‚Üí snake_case (Frontend ‚Üí API)\r\n   */\r\n  static FRONTEND_TO_API = {\r\n    // Champs g√©n√©riques\r\n    dateDebut: 'date_debut',\r\n    dateFin: 'date_fin',\r\n    numeroFacture: 'numero_facture',\r\n    montantTotal: 'montant_total',\r\n    \r\n    // Champs tarification\r\n    idService: 'service_id',\r\n    idUnite: 'unite_id',\r\n    typeTarifId: 'type_tarif_id', \r\n    clientId: 'client_id',\r\n    tarifId: 'tarif_id',\r\n    \r\n    // Champs utilisateur\r\n    prenomClient: 'prenom_client',\r\n    nomClient: 'nom_client',\r\n    emailClient: 'email_client',\r\n    \r\n    // Champs m√©tier\r\n    isDefault: 'is_default',\r\n    isActif: 'is_actif',\r\n    createdAt: 'created_at',\r\n    updatedAt: 'updated_at',\r\n    \r\n    // Ajoutez d'autres mappings selon vos besoins...\r\n  };\r\n  \r\n  /**\r\n   * Mapping snake_case ‚Üí camelCase (API ‚Üí Frontend) \r\n   * G√©n√©r√© automatiquement √† partir du mapping inverse\r\n   */\r\n  static API_TO_FRONTEND = Object.fromEntries(\r\n    Object.entries(FieldConverter.FRONTEND_TO_API).map(([key, value]) => [value, key])\r\n  );\r\n  \r\n  // ================================\r\n  // M√âTHODES DE CONVERSION\r\n  // ================================\r\n  \r\n  /**\r\n   * Convertit un objet du format Frontend vers API (camelCase ‚Üí snake_case)\r\n   * @param {object} data - Donn√©es √† convertir\r\n   * @param {object} options - Options de conversion\r\n   * @returns {object} Donn√©es converties\r\n   */\r\n  static toApiFormat(data, options = {}) {\r\n    const {\r\n      excludeFields = [],      // Champs √† ne pas convertir\r\n      customMapping = {},      // Mapping personnalis√© pour ce cas\r\n      preserveUnknown = true   // Garder les champs non mapp√©s\r\n    } = options;\r\n    \r\n    if (!data || typeof data !== 'object') {\r\n      log.warn('FieldConverter.toApiFormat: data invalide', data);\r\n      return data;\r\n    }\r\n    \r\n    const mapping = { ...FieldConverter.FRONTEND_TO_API, ...customMapping };\r\n    const converted = {};\r\n    \r\n    Object.keys(data).forEach(key => {\r\n      // Ignorer les champs exclus\r\n      if (excludeFields.includes(key)) {\r\n        return;\r\n      }\r\n      \r\n      // Utiliser le mapping ou garder la cl√© originale\r\n      const apiKey = mapping[key] || (preserveUnknown ? key : null);\r\n      \r\n      if (apiKey) {\r\n        converted[apiKey] = data[key];\r\n      }\r\n    });\r\n    \r\n    log.debug('üîÑ Conversion Frontend ‚Üí API:', { \r\n      original: data, \r\n      converted, \r\n      mapping: Object.keys(mapping).filter(k => data.hasOwnProperty(k))\r\n    });\r\n    \r\n    return converted;\r\n  }\r\n  \r\n  /**\r\n   * Convertit un objet du format API vers Frontend (snake_case ‚Üí camelCase)\r\n   * @param {object} data - Donn√©es √† convertir\r\n   * @param {object} options - Options de conversion\r\n   * @returns {object} Donn√©es converties\r\n   */\r\n  static toFrontendFormat(data, options = {}) {\r\n    const {\r\n      excludeFields = [],\r\n      customMapping = {},\r\n      preserveUnknown = true\r\n    } = options;\r\n    \r\n    if (!data || typeof data !== 'object') {\r\n      log.warn('FieldConverter.toFrontendFormat: data invalide', data);\r\n      return data;\r\n    }\r\n    \r\n    const mapping = { ...FieldConverter.API_TO_FRONTEND, ...customMapping };\r\n    const converted = {};\r\n    \r\n    Object.keys(data).forEach(key => {\r\n      if (excludeFields.includes(key)) {\r\n        return;\r\n      }\r\n      \r\n      const frontendKey = mapping[key] || (preserveUnknown ? key : null);\r\n      \r\n      if (frontendKey) {\r\n        converted[frontendKey] = data[key];\r\n      }\r\n    });\r\n    \r\n    // log.debug('üîÑ Conversion API ‚Üí Frontend:', { \r\n    //   original: data, \r\n    //   converted,\r\n    //   mapping: Object.keys(mapping).filter(k => data.hasOwnProperty(k))\r\n    // });\r\n    \r\n    return converted;\r\n  }\r\n  \r\n  /**\r\n   * Convertit un tableau d'objets\r\n   * @param {Array} dataArray - Tableau √† convertir\r\n   * @param {string} direction - 'toApi' ou 'toFrontend'\r\n   * @param {object} options - Options de conversion\r\n   * @returns {Array} Tableau converti\r\n   */\r\n  static convertArray(dataArray, direction = 'toApi', options = {}) {\r\n    if (!Array.isArray(dataArray)) {\r\n      log.warn('FieldConverter.convertArray: dataArray doit √™tre un tableau', dataArray);\r\n      return dataArray;\r\n    }\r\n    \r\n    const converter = direction === 'toApi' ? \r\n      FieldConverter.toApiFormat : \r\n      FieldConverter.toFrontendFormat;\r\n    \r\n    return dataArray.map(item => converter(item, options));\r\n  }\r\n  \r\n  // ================================\r\n  // M√âTHODES SP√âCIALIS√âES PAR CONTEXTE\r\n  // ================================\r\n  \r\n  /**\r\n   * Conversion sp√©cialis√©e pour les formulaires de tarification\r\n   */\r\n  static convertTarifFormData(formData, direction = 'toApi') {\r\n    const tarifMapping = {\r\n      // Mappings sp√©cifiques aux tarifs\r\n      prixUnitaire: 'prix_unitaire',\r\n      prixTotal: 'prix_total',\r\n      quantiteFacturee: 'quantite_facturee'\r\n    };\r\n    \r\n    const options = {\r\n      customMapping: direction === 'toApi' ? tarifMapping : \r\n        Object.fromEntries(Object.entries(tarifMapping).map(([k, v]) => [v, k]))\r\n    };\r\n    \r\n    return direction === 'toApi' ? \r\n      FieldConverter.toApiFormat(formData, options) :\r\n      FieldConverter.toFrontendFormat(formData, options);\r\n  }\r\n  \r\n  /**\r\n   * Conversion sp√©cialis√©e pour les donn√©es client\r\n   */\r\n  static convertClientData(clientData, direction = 'toApi') {\r\n    const clientMapping = {\r\n      adresseLigne1: 'adresse_ligne1',\r\n      adresseLigne2: 'adresse_ligne2',\r\n      codePostal: 'code_postal',\r\n      numeroTelephone: 'numero_telephone'\r\n    };\r\n    \r\n    const options = {\r\n      customMapping: direction === 'toApi' ? clientMapping :\r\n        Object.fromEntries(Object.entries(clientMapping).map(([k, v]) => [v, k]))\r\n    };\r\n    \r\n    return direction === 'toApi' ?\r\n      FieldConverter.toApiFormat(clientData, options) :\r\n      FieldConverter.toFrontendFormat(clientData, options);\r\n  }\r\n  \r\n  // ================================\r\n  // UTILITAIRES\r\n  // ================================\r\n  \r\n  /**\r\n   * Ajoute un nouveau mapping au syst√®me\r\n   * @param {object} newMappings - Nouveaux mappings { frontendKey: 'api_key' }\r\n   */\r\n  static addMappings(newMappings) {\r\n    Object.assign(FieldConverter.FRONTEND_TO_API, newMappings);\r\n    \r\n    // R√©g√©n√©rer le mapping inverse\r\n    const newApiToFrontend = Object.fromEntries(\r\n      Object.entries(newMappings).map(([key, value]) => [value, key])\r\n    );\r\n    Object.assign(FieldConverter.API_TO_FRONTEND, newApiToFrontend);\r\n    \r\n    log.debug('‚úÖ Nouveaux mappings ajout√©s:', newMappings);\r\n  }\r\n  \r\n  /**\r\n   * V√©rifie si un champ a un mapping d√©fini\r\n   * @param {string} fieldName - Nom du champ\r\n   * @param {string} direction - 'toApi' ou 'toFrontend'\r\n   * @returns {boolean}\r\n   */\r\n  static hasMappingFor(fieldName, direction = 'toApi') {\r\n    const mapping = direction === 'toApi' ? \r\n      FieldConverter.FRONTEND_TO_API : \r\n      FieldConverter.API_TO_FRONTEND;\r\n    \r\n    return mapping.hasOwnProperty(fieldName);\r\n  }\r\n  \r\n  /**\r\n   * Obtient le nom mapp√© d'un champ\r\n   * @param {string} fieldName - Nom du champ\r\n   * @param {string} direction - 'toApi' ou 'toFrontend'\r\n   * @returns {string|null} Nom mapp√© ou null si pas de mapping\r\n   */\r\n  static getMappedName(fieldName, direction = 'toApi') {\r\n    const mapping = direction === 'toApi' ? \r\n      FieldConverter.FRONTEND_TO_API : \r\n      FieldConverter.API_TO_FRONTEND;\r\n    \r\n    return mapping[fieldName] || null;\r\n  }\r\n  \r\n  /**\r\n   * Debug: affiche tous les mappings disponibles\r\n   */\r\n  static debugMappings() {\r\n    log.group('üîç FieldConverter - Mappings disponibles');\r\n    log.debug('Frontend ‚Üí API:', FieldConverter.FRONTEND_TO_API);\r\n    log.debug('API ‚Üí Frontend:', FieldConverter.API_TO_FRONTEND);\r\n    log.groupEnd();\r\n  }\r\n}\r\n\r\n// Export par d√©faut\r\nexport default FieldConverter;"],"mappings":"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","ignoreList":[]}